(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["pages/agent/tobuy/tobuy"],{

/***/ 276:
/*!***************************************************************************************!*\
  !*** E:/HBuilderProjects/MotorOrder/main.js?{"page":"pages%2Fagent%2Ftobuy%2Ftobuy"} ***!
  \***************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(createPage) {__webpack_require__(/*! uni-pages */ 4);
var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 2));
var _tobuy = _interopRequireDefault(__webpack_require__(/*! ./pages/agent/tobuy/tobuy.vue */ 277));function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}
createPage(_tobuy.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 1)["createPage"]))

/***/ }),

/***/ 277:
/*!******************************************************************!*\
  !*** E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue ***!
  \******************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./tobuy.vue?vue&type=template&id=4120c9b2&scoped=true& */ 278);
/* harmony import */ var _tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./tobuy.vue?vue&type=script&lang=js& */ 280);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _tobuy_vue_vue_type_style_index_0_id_4120c9b2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./tobuy.vue?vue&type=style&index=0&id=4120c9b2&scoped=true&lang=css& */ 282);
/* harmony import */ var _D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */ 10);

var renderjs





/* normalize component */

var component = Object(_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"],
  _tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  "4120c9b2",
  null,
  false,
  _tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"],
  renderjs
)

component.options.__file = "E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 278:
/*!*************************************************************************************************************!*\
  !*** E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue?vue&type=template&id=4120c9b2&scoped=true& ***!
  \*************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tobuy.vue?vue&type=template&id=4120c9b2&scoped=true& */ 279);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return _D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["recyclableRender"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "components", function() { return _D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_template_id_4120c9b2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"]; });



/***/ }),

/***/ 279:
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue?vue&type=template&id=4120c9b2&scoped=true& ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return recyclableRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
var render = function () {}
var staticRenderFns = []
var recyclableRender
var components



/***/ }),

/***/ 280:
/*!*******************************************************************************************!*\
  !*** E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _D_360_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tobuy.vue?vue&type=script&lang=js& */ 281);
/* harmony import */ var _D_360_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_D_360_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _D_360_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _D_360_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_D_360_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 281:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue?vue&type=script&lang=js& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(uni) {Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var uniLoadMore = function uniLoadMore() {__webpack_require__.e(/*! require.ensure | components/uni-load-more/uni-load-more */ "components/uni-load-more/uni-load-more").then((function () {return resolve(__webpack_require__(/*! @/components/uni-load-more/uni-load-more.vue */ 499));}).bind(null, __webpack_require__)).catch(__webpack_require__.oe);};var _default =














































































































































{
  components: {
    uniLoadMore: uniLoadMore },

  data: function data() {
    return {
      duration: 500,
      proList: [], //产品列表
      userInfo: {}, //用户信息
      custInfo: {},
      enter: '', //判断是推荐还是下单
      note: '', //代下单备注
      isShow: false, //代下单弹层
      totalPrice: 0, //总价格
      totalNum: 0, //总数量
      tabList: [
      {
        pagePath: '../index/index',
        iconPath: "../../../static/images/icon_index_bottom01.png",
        selectedIconPath: "../../../static/images/icon_index_bottom11.png",
        text: '首页',
        badge: '' },
      {
        pagePath: '../customer/customer',
        iconPath: "../../../static/images/icon_index_bottom05.png",
        selectedIconPath: "../../../static/images/icon_index_bottom15.png",
        text: '代客下单',
        badge: '' },
      {
        pagePath: '../user/user',
        iconPath: "../../../static/images/icon_index_bottom04.png",
        selectedIconPath: "../../../static/images/icon_index_bottom14.png",
        text: '我的',
        badge: '' }],


      tabNum: 3,
      currentTabIndex: 1,
      keyTxt: '', //关键字
      cartItem: [], //选择商品
      priview: [], //订单预览
      erpcode: "", //产品编号
      isload: false,
      searchList: [],
      isSearch: false,
      isClick: false };

  },
  onLoad: function onLoad(option) {
    var this_ = this;

    uni.getStorage({
      key: 'userInfo',
      success: function success(res) {
        this_.userInfo = res.data[0];
        if (Object.getOwnPropertyNames(option).length != 0) {
          this_.erpcode = option.code;
        }
        //console.log(this_.erpcode);
        if (this_.userInfo.c_level == 1 && this_.userInfo.c_admin == 1) {
          this_.tabList.splice(1, 0, {
            pagePath: '../tobuy/tobuy',
            iconPath: "../../../static/images/icon_index_bottom06.png",
            selectedIconPath: "../../../static/images/icon_index_bottom16.png",
            text: '进货',
            badge: '' });

          this_.tabNum = 4;
        }
        this_.getProduct(); //产品列表
      } });


  },
  methods: {
    //产品列表
    getProduct: function getProduct() {
      var this_ = this;
      //获取产品列表
      uni.showLoading();
      this_.$http.httpTokenRequest({
        url: this_.$api.ProductHome + '?tag=' + this_.keyTxt + '&code=' + this_.erpcode,
        method: 'GET',
        data: {} }).
      then(function (res) {
        //请求成功
        uni.hideLoading();
        if (!this_.isSearch) {
          this_.proList = res.data.rows;
          for (var i = 0; i < res.data.rows.length; i++) {
            this_.$set(this_.proList[i], 'inprice', 0);
            this_.$set(this_.proList[i], 'zstorage', 0);
            this_.$set(this_.proList[i], 'stockList', []);
            this_.$set(this_.proList[i], 'companyName', '');
            this_.$set(this_.proList[i], 'storemin', 0);
          }
        } else {
          this_.searchList = res.data.rows;
          for (var _i = 0; _i < res.data.rows.length; _i++) {
            this_.$set(this_.searchList[_i], 'inprice', 0);
            this_.$set(this_.searchList[_i], 'zstorage', 0);
            this_.$set(this_.searchList[_i], 'stockList', []);
            this_.$set(this_.searchList[_i], 'companyName', '');
            this_.$set(this_.searchList[_i], 'storemin', 0);
          }
        }

        this_.getInPrice(); //进价
        //this_.getStoreQty();//库存
        this_.getStoreMinQty(); //自己库存
      }, function (error) {
        console.log(error);
      });
    },

    //进详情
    toDetail: function toDetail(item) {
      var this_ = this;
      uni.navigateTo({
        url: '../detail/detail?code=' + item.erpcode + '&type=tobuy' });

    },

    //获取进货价
    getInPrice: function getInPrice() {
      var this_ = this;
      this_.$http.httpTokenRequest({
        url: this_.$api.InPrice + '?c_ma001=' + this_.userInfo.c_ma001 + '&code=',
        method: 'GET',
        data: {} }).
      then(function (res) {
        //请求成功
        console.log(res);
        if (!this_.isSearch) {
          for (var i = 0; i < res.data.length; i++) {
            for (var j = 0; j < this_.proList.length; j++) {
              if (res.data[i].mb001 == this_.proList[j].erpcode) {
                this_.proList[j].inprice = res.data[i].price.toFixed(2);
              }
            }
          }
        } else {
          for (var _i2 = 0; _i2 < res.data.length; _i2++) {
            for (var _j = 0; _j < this_.searchList.length; _j++) {
              if (res.data[_i2].mb001 == this_.searchList[_j].erpcode) {
                this_.searchList[_j].inprice = res.data[_i2].price.toFixed(2);
              }
            }
          }
        }

        this_.getStoreQty(); //库存
      }, function (error) {
        console.log(error);
      });
    },

    //获取库存
    getStoreQty: function getStoreQty() {
      var this_ = this;
      this_.$http.httpTokenRequest({
        url: this_.$api.StoreQty + '?c_id= ' + this_.userInfo.c_id + '&storage=' + this_.userInfo.storage + '&code=',
        method: 'GET',
        data: {} }).
      then(function (res) {
        //请求成功
        // console.log("获取库存");
        // console.log(res);
        if (!this_.isSearch) {
          for (var z = 0; z < this_.proList.length; z++) {
            for (var m = 0; m < res.data.length; m++) {
              if (res.data[m].mc001 == this_.proList[z].erpcode) {
                if (res.data[m].mc007 == 0) {
                  var storageName = "预定提醒";
                } else {
                  var storageName = res.data[m].storage;
                }
                var obj = {
                  'name': res.data[m].storage,
                  'bname': storageName,
                  'storage': res.data[m].mc007,
                  'mc002': res.data[m].mc002,
                  'mb001': this_.proList[z].erpcode,
                  'inprice': this_.proList[z].inprice,
                  'type': this_.keyTxt,
                  's_qty': res.data[m].s_qty == null ? 0 : res.data[m].s_qty };

                this_.proList[z].stockList.push(obj);
                this_.proList[z].zstorage = this_.proList[z].zstorage + res.data[m].mc007;
              }
            }
          }
          this_.getTotalPrice();
        } else {
          for (var _z = 0; _z < this_.searchList.length; _z++) {
            for (var _m = 0; _m < res.data.length; _m++) {
              if (res.data[_m].mc001 == this_.searchList[_z].erpcode) {
                if (res.data[_m].mc007 == 0) {
                  var storageName = "预定提醒";
                } else {
                  var storageName = res.data[_m].storage;
                }
                var _obj = {
                  'name': res.data[_m].storage,
                  'bname': storageName,
                  'storage': res.data[_m].mc007,
                  'mc002': res.data[_m].mc002,
                  'mb001': this_.searchList[_z].erpcode,
                  'inprice': this_.searchList[_z].inprice,
                  'type': this_.keyTxt,
                  's_qty': res.data[_m].s_qty == null ? 0 : res.data[_m].s_qty };

                this_.searchList[_z].stockList.push(_obj);
                this_.searchList[_z].zstorage = this_.searchList[_z].zstorage + res.data[_m].mc007;
              }
            }
          }
          this_.isClick = false;
          this_.getTotalPrice();
        }

        this_.isload = true;
      }, function (error) {
        console.log(error);
      });
    },

    //获取自己库存
    getStoreMinQty: function getStoreMinQty() {
      var this_ = this;
      this_.$http.httpTokenRequest({
        url: this_.$api.CustStorage + '?c_id=' + this_.userInfo.c_id + '&ma002=' + this_.userInfo.c_ma002 + '&level=' + this_.userInfo.c_level + '&m_id=' + this_.userInfo.c_m_id + '&isonway=0',
        method: 'GET',
        data: {} }).
      then(function (res) {
        //请求成功
        if (!this_.isSearch) {
          for (var l = 0; l < this_.proList.length; l++) {
            for (var k = 0; k < res.data.length; k++) {
              if (res.data[k].erpcode == this_.proList[l].erpcode) {
                this_.proList[l].storemin = this_.proList[l].storemin + res.data[k].qty;
              }
            }
          }
        } else {
          for (var _l = 0; _l < this_.searchList.length; _l++) {
            for (var _k = 0; _k < res.data.length; _k++) {
              if (res.data[_k].erpcode == this_.searchList[_l].erpcode) {
                this_.searchList[_l].storemin = this_.searchList[_l].storemin + res.data[_k].qty;
              }
            }
          }
        }

      }, function (error) {
        console.log(error);
      });
    },

    //加减购物车
    changeCart: function changeCart(e, index, list, item) {
      var this_ = this;
      if (this_.isSearch) {
        for (var i = 0; i < this_.proList.length; i++) {
          if (item.erpcode == this_.proList[i].erpcode) {
            var storeArr = this_.proList[i].stockList;
            for (var j = 0; j < storeArr.length; j++) {
              if (storeArr[j].mc002 == list.mc002) {
                this_.proList[i].stockList[j].s_qty = e;
              }
            }
          }
        }
      }
      if (this_.isload) {
        this_.$set(list, 's_qty', e);
        //console.log("list");
        this_.$http.httpTokenRequest({
          url: this_.$api.CustShopCart,
          method: 'POST',
          data: {
            "c_id": this_.userInfo.c_id,
            "c_ma001": this_.userInfo.c_ma001,
            "c_ma002": this_.userInfo.c_ma002,
            "i_mb001": list.mb001,
            "qty": e,
            "mc002": list.mc002 } }).

        then(function (res) {
          //请求成功
          //console.log(res);
          this_.getTotalPrice();
        }, function (error) {
          console.log(error);
        });
      }
    },
    //计算总价
    getTotalPrice: function getTotalPrice() {
      var this_ = this;
      this_.totalNum = 0;
      this_.totalPrice = 0;
      for (var i = 0; i < this_.proList.length; i++) {
        var stockList = this_.proList[i].stockList;
        for (var m = 0; m < stockList.length; m++) {
          if (stockList[m].storage > 0 && stockList[m].s_qty > 0) {

            this_.totalNum = parseInt(this_.totalNum) + parseInt(stockList[m].s_qty);
            this_.totalPrice = this_.totalPrice + stockList[m].s_qty * stockList[m].inprice;

          } else if (stockList[m].storage == 0 && stockList[m].s_qty > 0) {
            this_.remind(stockList[m]);
          }
        }
      }
    },

    // changeCart(e,index,list){
    // 	let this_ = this;
    // 	this_.$set(list[index],'s_qty',e);
    // 	this_.totalNum = 0;
    // 	this_.totalPrice = 0;
    // 	for(let i=0;i<this_.proList.length;i++){
    // 		for(let m = 0; m < this_.proList[i].stockList.length; m++){
    // 			if(!this_.$check.isEmpty(this_.proList[i].stockList[m].s_qty)){
    // 				if(this_.proList[i].stockList[m].storage > 0){
    // 					this_.totalNum = parseInt(this_.totalNum) + parseInt(this_.proList[i].stockList[m].s_qty);
    // 					this_.totalPrice = this_.totalPrice + (this_.proList[i].stockList[m].s_qty*this_.proList[i].inprice);

    // 				}else{
    // 					this_.remind(this_.proList[i].stockList[m]);
    // 				}
    // 			}
    // 		}
    // 	}
    // },
    //提交订单
    toSumit: function toSumit() {
      var this_ = this;
      this_.cartItem = [];
      var oldData = [];
      console.log(this_.proList);

      for (var i = 0; i < this_.proList.length; i++) {
        for (var m = 0; m < this_.proList[i].stockList.length; m++) {
          if (!this_.$check.isEmpty(this_.proList[i].stockList[m].s_qty)) {
            if (this_.proList[i].stockList[m].s_qty != 0) {var










































              newData;var
              newObj;(function () {if (this_.proList[i].stockList[m].storage > 0) {this_.cartItem.push({ mc002: this_.proList[i].stockList[m].mc002, mb001: this_.proList[i].stockList[m].mb001, qty: this_.proList[i].stockList[m].s_qty, price: this_.proList[i].inprice });} //预览的订单信息
                var a = { erpcode: this_.proList[i].erpcode, name: this_.proList[i].title, qty: this_.proList[i].stockList[m].s_qty, price: this_.proList[i].inprice, storageName: this_.proList[i].stockList[m].bname, storage: this_.proList[i].zstorage };oldData.push(a); // 把源数据先变成目标数据的规则
                var oldDataRule = [];oldData.forEach(function (el) {var oldObj = { name: el.storageName, list: [] };var listObj = { erpcode: el.erpcode, name: el.name, qty: el.qty, price: el.price, storage: el.storage };oldObj.list.push(listObj);oldDataRule.push(oldObj);}); /**
                                                                                                                                                                                                                                                                                    * 先去重，后合并
                                                                                                                                                                                                                                                                                    * 1、源数据去重
                                                                                                                                                                                                                                                                                    * 2、把去重后的数据和源数据中相同name的数据合并list
                                                                                                                                                                                                                                                                                   */newData = [];newObj = {};oldDataRule.forEach(function (el, i) {if (!newObj[el.name]) {newData.push(el);newObj[el.name] = true;} else {newData.forEach(function (el) {
                      if (el.name === oldDataRule[i].name) {
                        el.list = el.list.concat(oldDataRule[i].list);
                      }
                    });
                  }
                });

                this_.priview = newData.sort(this_.compare);
                for (var k = 0; k < this_.priview.length; k++) {
                  this_.$set(this_.priview[k], 'nums', 0);
                  this_.$set(this_.priview[k], 'money', 0);
                  for (var j = 0; j < this_.priview[k].list.length; j++) {
                    this_.priview[k].nums = this_.priview[k].nums + parseInt(this_.priview[k].list[j].qty);
                    this_.priview[k].money = this_.priview[k].money + this_.priview[k].list[j].qty * this_.priview[k].list[j].price;
                  }
                }
                // console.log("-----------排序后----------------");
                // console.log(this_.priview);
              })();}

          }
        }
      }
      if (this_.cartItem.length > 0) {
        this_.isShow = true;
      } else {
        uni.showToast({
          icon: 'none',
          title: '请选择产品',
          duration: 1500 });

      }

    },
    //数组排序
    compare: function compare(obj1, obj2) {
      var val1 = obj1.name;
      var val2 = obj2.name;
      if (val1 < val2) {
        return -1;
      } else if (val1 > val2) {
        return 1;
      } else {
        return 0;
      }
    },

    //”备注“弹层确认提交
    confirmSub: function confirmSub() {
      var this_ = this;
      uni.showLoading();
      this_.$http.httpTokenRequest({
        url: this_.$api.OrderNew,
        method: 'POST',
        data: {
          "c_id": this_.userInfo.c_id,
          "c_openid": this_.userInfo.c_openid,
          "c_nickname": this_.userInfo.c_nickname,
          "c_ma001": this_.userInfo.c_ma001,
          "c_ma002": this_.userInfo.c_ma002,
          "c_tel": this_.userInfo.c_tel,
          "c_address": this_.userInfo.c_address,
          "note": this_.note,
          "storage": this_.userInfo.storage,
          "item": this_.cartItem,
          "m_id": this_.userInfo.c_m_id } }).

      then(function (res) {
        //请求成功
        uni.hideLoading();
        if (res.data.State) {
          uni.showToast({
            title: '订单提交成功！',
            duration: 1500 });

          setTimeout(function () {
            uni.navigateTo({
              url: '../myorder/myorder' });

          }, 1500);
        }
      }, function (error) {
        console.log(error);
      });
      this_.isShow = false;
    },
    //查询
    toSearch: function toSearch() {
      var this_ = this;
      if (!this_.isClick) {
        this_.isSearch = true;
        this_.isClick = true;
        this_.getProduct();
      }


    },
    //预定产品
    remind: function remind(item) {
      //console.log(item);
      var this_ = this;
      this_.$http.httpTokenRequest({
        url: this_.$api.Remind,
        method: 'POST',
        data: {
          c_id: this_.userInfo.c_id,
          mb001: item.mb001,
          qty: item.s_qty,
          mc002: item.mc002 } }).

      then(function (res) {
        //console.log(res);
        // if(res.data.State){
        // 	uni.showToast({
        // 		icon : 'success',
        // 		title : '添加成功!',
        // 		duration:1500
        // 	})
        // }
      }, function (error) {
        console.log(error);
      });
    } } };exports.default = _default;
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 1)["default"]))

/***/ }),

/***/ 282:
/*!***************************************************************************************************************************!*\
  !*** E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue?vue&type=style&index=0&id=4120c9b2&scoped=true&lang=css& ***!
  \***************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _D_360_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_D_360_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_style_index_0_id_4120c9b2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./tobuy.vue?vue&type=style&index=0&id=4120c9b2&scoped=true&lang=css& */ 283);
/* harmony import */ var _D_360_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_D_360_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_style_index_0_id_4120c9b2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_D_360_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_D_360_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_style_index_0_id_4120c9b2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _D_360_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_D_360_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_style_index_0_id_4120c9b2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _D_360_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_D_360_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_style_index_0_id_4120c9b2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_D_360_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_D_360_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_D_360_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_D_360_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_tobuy_vue_vue_type_style_index_0_id_4120c9b2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 283:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/HBuilderProjects/MotorOrder/pages/agent/tobuy/tobuy.vue?vue&type=style&index=0&id=4120c9b2&scoped=true&lang=css& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[276,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/agent/tobuy/tobuy.js.map